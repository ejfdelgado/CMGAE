var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},hayValor=function(a){return void 0!=a&&null!=a&&(!("string"==typeof a)||a.trim().length>0)},esFuncion=function(a){return"function"==typeof a},esNumero=function(a){return"number"==typeof a||/^\d+$/.test(a)},esBoolean=function(a){return"boolean"==typeof a},esObjeto=function(a){return"object"==(void 0===a?"undefined":_typeof(a))&&null!==a},esLista=function(a){return hayValor(a)&&a instanceof Array},esMultilenguaje=function(a){return/^(\S)+(\.\S+)+$/gim.test(a)},leerObj=function(a,o,n,t){if(!hayValor(o)||!esObjeto(a))return n;for(var e=o.split("."),i=a,r=0;r<e.length;r++){var c=e[r];if(esNumero(c)&&esLista(i)&&(c=parseInt(c)),i=i[c],r!=e.length-1&&!esObjeto(i))return n}return hayValor(i)?!0!==t&&esFuncion(i)?i():i:n},asignarObj=function(a,o,n){for(var t=o.split("."),e=a,i=0;i<t.length;i++){var r=t[i];esNumero(r)&&(r=parseInt(r)),esObjeto(e)&&(i==t.length-1?esLista(e[r])&&esLista(n)&&e[r]!==n?(e[r].splice(0,e[r].length),$.each(n,function(a,o){e[r].push(o)})):e[r]=n:((Object.keys(e).indexOf(""+r)<0||null==e[r])&&(esNumero(t[i+1])?e[r]=[]:e[r]={}),e=e[r]))}},darRutasObjeto=function(a,o){var n=[];return function a(t,e){esObjeto(t)?$.each(t,function(t,i){var r=null;r=null===e?t:e+"."+t,esFuncion(o)&&o(i)&&n.push(r),a(i,r)}):null!==e&&(esFuncion(o)?o(t)&&n.push(e):n.push(e))}(a,null),n},predefinir=function(a,o){for(var n=darRutasObjeto(o),t=0;t<n.length;t++){var e=n[t];if(!hayValor(leerObj(a,e,null,!0))){var i=leerObj(o,e,null,!0);asignarObj(a,e,i)}}return a},configurarListasEditor=function(a,o){a.use(new a.RdfaService);for(var n in o){for(var t=n+"Rel",e=o[n],i=[],r=0;r<e.campos.length;r++){var c=e.campos[r];i.push({id:c.nombre,range:c.tipo,min:0,max:1})}a.types.add(n,i);for(var u=0;u<e.listas.length;u++){var d=e.listas[u];a.types.add(d.nombre,[{id:t,range:n,min:0,max:-1}])}a.service("rdfa").setTemplate(n,t,jQuery(e.ejemplo).html())}},tieneAtributo=function(a,o){var n=a.attr(o);return"undefined"!==(void 0===n?"undefined":_typeof(n))&&!1!==n},activarConteoRegresivo=function(){$(".mycountdown").each(function(a,o){var n=$(o),t=n.text(),e=n.attr("data-count-format");n.countdown(t,function(a){$(this).text(a.strftime(e))})})};if(!hayValor(moduloActividad))var moduloActividad=function(){var a=0;return{on:function(o){if(hayValor(o)||(o=""),0==a){var n=$('<div id="loading"><p></p></div>');n.find("p").html(o),$("body").append(n)}a++},off:function(){--a<=0&&(a=0,$("#loading").remove())}}}();if(!hayValor(moduloHttp))var moduloHttp=function(){return{get:function(a){var o=$.Deferred();return moduloActividad.on(),$.ajax({url:a,type:"GET",cache:!1}).done(function(a){o.resolve(a)}).fail(function(){o.reject()}).always(function(){moduloActividad.off()}),o.promise()}}}();if(!hayValor(moduloLocal))var moduloLocal=function(){var a={lengua:LENGUAJE,lenguapred:LENGUAJE_PRED},o=null,n=function(a){return esObjeto(o)?leerObj(o,a,a):a},t=function(a){$.each(a.find(".traducir"),function(a,o){var t=$(o),e=t.text();if(esMultilenguaje(e)){var i=n(e);i!=e&&t.html(i)}})},e=function(a,o){var n=a.attr("data-value");if(n){var t=new Date(0);try{t.setUTCSeconds(parseInt(n))}catch(a){}if(a.find("[data-format]").each(function(a,o){var n=$(o),e=n.attr("data-format"),i=$.format.date(t.getTime(),e);n.text(i)}),void 0!==o)return $.format.date(t.getTime(),o)}return""},i=function(a){a.find("[dateProperty]").each(function(a,o){var n=$(o);e(n)})},r=function(){$("[data-lenguaje]").each(function(o,n){var t=$(n),e=t.attr("data-lenguaje");t.off("click","**"),t.on("click",function(){var o=/(http)(s?)(:)(\/\/)(.*?)(\/)((leng-)(.*?)(\/))?(.*)/g.exec(window.location);if(o){for(var n="",t=!0,i=o[9],r=e===a.lenguapred,c=1;c<o.length;c++){var u=o[c];if(c<=6||c>=11)void 0!==u&&(n+=u);else{if(r){if(void 0===i)return}else if(i===e)return;!r&&t&&(n+="leng-"+e+"/",t=!1)}}window.location=n}})})};return function(){var n=moduloHttp.get("/assets/cmgae/local/"+a.lengua+".json");$.when(n).then(function(a){o=JSON.parse(a)}),i($("body")),r()}(),{traducir:n,procesarElemento:t,epochAFechaElem:i}}();if(!hayValor(moduloApp))var moduloApp=function(){var a={URL_LOGIN:URL_LOGIN,URL_LOGOUT:URL_LOGOUT,HAS_USER:HAS_USER,IS_ADMIN:IS_ADMIN},o=function(){return a.IS_ADMIN},n=function(){return a.HAS_USER},t=function(){moduloActividad.on(),window.location.href=a.URL_LOGIN},e=function(){moduloActividad.on(),window.location.href=a.URL_LOGOUT},i=function(){"full"===$("body").data("Midgard-midgardToolbar").options.display?($("body").data("Midgard-midgardToolbar").__proto__.hide(),$("body").data("Midgard-midgardToolbar").options.display="minimized"):($("body").data("Midgard-midgardToolbar").__proto__.show(),$("body").data("Midgard-midgardToolbar").options.display="full")};return{esAdmin:o,esUsuario:n,login:t,logout:e,borrarCache:function(){var a=$.Deferred();return moduloActividad.on(),$.ajax({type:"GET",url:"/act/clearmemcache",data:JSON.stringify({}),contentType:"application/json; charset=utf-8"}).done(function(o){a.resolve()}).fail(function(o,n){a.reject()}).always(function(){moduloActividad.off()}),a.promise()},abrirBarraEdicion:i}}();if(!hayValor(moduloMenus))var moduloMenus=function(){var a=[],o=function(a){return moduloHttp.get("/assets/cmgae/menus"+a)},n=function(o){return 0!=a.length&&a[a.length-1].id==o},t=function(){if(0!=a.length){a[a.length-1].nodo.remove(),a.pop()}},e=function(a){var n=o("/soloTexto.html");$.when(n).then(function(o){d("alerta",o,{html:{".mensaje_texto":a}})})},i=function(){e(moduloLocal.traducir("menus.mensajes.error"))},r=function(a){$.when(a).then(function(){e(moduloLocal.traducir("menus.mensajes.hecho"))},i)},c=function(a,o){moduloLocal.procesarElemento(a);var n={funciones:{".menu_opc_ingresar":moduloApp.login,".menu_opc_salir":moduloApp.logout,".menu_opc_borrar_cache":moduloApp.borrarCache,".create-ui-toggle2":moduloApp.abrirBarraEdicion,".menuEliminar":moduloEdicion.funcElegirBorrar},html:{},botones:{}};if(n=$.extend(n,o),$.each(n.funciones,function(o,n){a.find(o).on("click",function(){t();var a=n();hayValor(a)&&r(a)})}),esObjeto(n.botones)){var e=$('<div class="row"><div class="col-xs-12"><div class="text-right botones-aca"></div></div></div>'),i={texto:"?",clase:"btn-primary",accion:function(){}};$.each(n.botones,function(a,o){predefinir(o,i);var n=$('<button type="button" class="btn btn-xs"></button>');n.on("click",o.accion),n.addClass(o.clase),n.text(o.texto),e.find(".botones-aca").append(n)}),a.append(e)}for(var c in n.html)a.find(c).html(n.html[c])},u=function(){var a=o("/confirmar.html"),n=$.Deferred();return $.when(a).then(function(a){var o={botones:{aceptar:{texto:moduloLocal.traducir("menus.botones.aceptar"),clase:"btn-success",accion:function(){n.resolve()}},cancelar:{texto:moduloLocal.traducir("menus.botones.cancelar"),clase:"btn-danger",accion:function(){n.reject()}}}};d("confirmacion",a,o)}),n.promise()},d=function(o,n,t){var e=$(n);$("body").append(e),a.push({id:o,nodo:e}),c(e,t)},l=function(){var a=$.Deferred();if(n("menu"))return t(),a.reject(),a.promise();var e=null;return e=o(moduloApp.esUsuario()?moduloApp.esAdmin()?"/menuInicialAdmin.html":"/menuInicialAnonimo.html":"/menuInicialAnonimo.html"),$.when(e).then(function(o){d("menu",o),a.resolve()}),a.promise()},s=function(){pila.push("menu_pagina"),$(".menu_core").toggleClass("invisible"),$(".menu_pagina").toggleClass("invisible"),window.scrollTo(0,0)},f=function(a,o,n,t){pila.push("formhtml"),$(".formhtml").attr("nodo2",a),$(".formhtml").attr("property2",o),$(".formhtml").attr("sufijo",t),$(".formhtml textarea").val(n),$(".formhtml").removeClass("invisible")};return $(document).keyup(function(o){27==o.keyCode&&(0==a.length?l():t())}),{mostrarMenuPagina:s,mostrarFormularioEdicion:f,mostrarMenuBasico:l,mostrarMenuSoloTexto:e,confirmar:u,sacarUltimo:t,error:i}}();if(!hayValor(moduloEdicion))var moduloEdicion=function(){var mapaIds={},activarEdicionOk=!1,activarEdicion=function(){1!=activarEdicionOk&&"undefined"!=typeof Backbone&&(Backbone.sync=function(a,o,n){try{var t=o.toJSON(),e=t["@subject"];o.isNew()&&(e in mapaIds?t["@subject"]=mapaIds[e]:(t["@subject"]="<"+(new Date).getTime()+"_"+Math.floor(10*Math.random()+1)+">",mapaIds[e]=t["@subject"]));var i=t["@subject"],r=t["@type"],c=/(viejs\.org\/ns\/)(.*)(>)/g.exec(r),u=null;c&&(u=c[2]);var d=/(<)(.*)(>)/g,l=d.exec(i);if(null==l)return void n.error("error: no es identificador "+i);var s=l[2],f={};for(var p in t){var c=/(viejs\.org\/ns\/)(.*)(>)/g.exec(p);c&&(f[c[2]]=t[p])}var m={};switch(m.payload=f,m.leng=LENGUAJE,a){case"create":case"update":moduloActividad.on(),$.ajax({type:"PUT",url:"/rest/"+(null===u||void 0===u?"Documento":u)+"/"+s,data:JSON.stringify(m),contentType:"application/json; charset=utf-8"}).done(function(a){n.success(o)}).fail(function(a,o){n.error("error")}).always(function(){moduloActividad.off()})}}catch(a){n.error("error "+a)}},activarEdicionOk=!0)},activarPaginacion=function activarPaginacion(nodo){function activatePageA(actual){var cursor=actual.attr("data-next"),busqueda=JSON.parse(actual.attr("data-q")),template=actual.attr("data-tpl"),target=actual.attr("data-target"),ipage=parseInt(actual.attr("data-page"));busqueda.n||(busqueda.n=100),moduloApp.esAdmin()||actual.html(ipage*busqueda.n+1+" al "+(ipage+1)*busqueda.n),"1"===actual.attr("data-noa")&&(actual.removeAttr("href"),actual.on("click",function(){var docHtml=document.getElementById(template).innerHTML,destino=$(target),postload=destino.attr("data-postload");destino.length>0&&(moduloActividad.on(),$.ajax({type:"PUT",url:"/paginar/",data:JSON.stringify({busqueda:busqueda,cursor:cursor}),contentType:"application/json; charset=utf-8"}).done(function(msg){var datos=msg.datos,sigui=msg.next;destino.empty();for(var i=0;i<datos.length;i++){var dato=datos[i],nuevo=$(docHtml);llenarTemplate(nuevo,dato),destino.append(nuevo)}if(void 0!==sigui&&sigui.length>0){var padrePaginacion=actual.closest(".paginacion");if(0==padrePaginacion.find("[data-next='"+sigui+"']").length){for(var padreLocal=actual.parent(),nombreTAG=padreLocal.prop("tagName"),cambio=!1;padreLocal.get(0)!=padrePaginacion.get(0)&&"BODY"!=nombreTAG;)cambio=!0,actual=padreLocal,padreLocal=padreLocal.parent(),nombreTAG=padreLocal.prop("tagName");var paginaSigui=actual.clone(),paginaSigui2;paginaSigui2=cambio?paginaSigui.find("[data-next]"):paginaSigui,paginaSigui2.attr("data-page",ipage+1),paginaSigui2.attr("data-next",sigui),padrePaginacion.append(paginaSigui),activatePageA(paginaSigui2)}}void 0!==postload&&eval(postload)}).fail(function(a,o){moduloMenus.mostrarMenuSoloTexto("Error paginando")}).always(function(){moduloActividad.off()}))}))}hayValor(nodo)||(nodo=$("body")),$.each(nodo.find("a[data-next]"),function(a,o){activatePageA($(o))})},funcElegirBorrar=function(){var a=$(".btnEliminar");a.length>0?a.remove():$("[about]").each(function(a,o){var n=$(o),t=n.find(".btnEliminar");if(0==t.length){n.prepend($('<div class="btnEliminar"><div class="btnEliminarX btnEliminar2 manito"></div></div>')),t=n.find(".btnEliminar");t.find(".btnEliminar2").click(function(){var a=moduloMenus.confirmar();$.when(a).then(function(){var a=n,o=a.attr("about"),t=null;t=a.attr("typeof");var e=(hayValor(t)?t:"")+"_"+o;e in mapaIds&&(o=mapaIds[e]),moduloActividad.on(),$.ajax({type:"DELETE",url:"/rest/"+(hayValor(t)?t:"")+"/"+o}).done(function(o){a.remove(),$("body").data("Midgard-midgardNotifications").create({body:JSON.stringify(o)}),location.reload()}).fail(function(a,o){$("body").data("Midgard-midgardNotifications").create({body:TRADUCTOR.error_ajax[LENGUAJE]})}).always(function(){moduloActividad.off()}),moduloMenus.sacarUltimo()},function(){moduloMenus.sacarUltimo()})})}}),"menu"===pila[pila.length-1]&&pila.pop()};return activarPaginacion(),{activarPaginacion:activarPaginacion,activarEdicion:activarEdicion,funcElegirBorrar:funcElegirBorrar}}();if(!hayValor(moduloContactenos))var moduloContactenos=function(){function a(a,o,n){var t="div",e=a.prop("tagName");"UL"!=e&&"OL"!=e||(t="li");var i=$("<"+t+' property="'+n+'" class="'+n+'"></'+t+">");i.text(o),a.prepend(i)}function o(a){var o=a.attr("validacion"),n=a.attr("placeholder");if(void 0===n&&(n=a.attr("name")),void 0!==o){void 0===n&&(n=o);var t=new RegExp(o,"gi");if(!a.val().match(t))return{error:1,msg:moduloLocal.traducir("general.verifique")+n}}return{error:0}}function n(a,o){a.find("input[type=text],select,textarea").each(function(a,n){var t=$(n),e=t.attr("name");void 0===e&&(e=t.attr("placeholder")),e in o&&t.val(o[e])}),a.find("input[type=checkbox]").each(function(a,n){var t=$(n),e=t.attr("name");void 0===e&&(e=t.attr("placeholder")),e in o&&(1==o[e]?t.prop("checked",!0):t.prop("checked",!1))}),a.find("input[type=radio]").each(function(a,n){var t=$(n),e=t.attr("name");void 0===e&&(e=t.attr("placeholder")),e in o&&(o[e]==t.attr("value")?t.prop("checked",!0):t.prop("checked",!1))})}function t(a,n){var t=[];return a.find("input[type=text],textarea").each(function(a,n){var e=$(n),i=o(e);t.push(i)}),a.find("input[type=text],select,textarea,input[type=radio]:checked").each(function(a,o){var t=$(o),e=t.attr("name");if(void 0===e&&(e=t.attr("placeholder")),void 0!==e){var i=t.val();n[e]=i}}),a.find("input[type=checkbox]").each(function(a,o){var t=$(o),e=t.attr("name");if(void 0===e&&(e=t.attr("placeholder")),void 0!==e){var i=t.is(":checked")?1:0;n[e]=i}}),t}return function(){$(".contenedor-envio-mensajes[data-preload]").each(function(a,o){var t=$(this),e=t.attr("data-preload");void 0!==e&&0!=e.length&&$.ajax({type:"GET",url:e,contentType:"application/json; charset=utf-8"}).done(function(a){n(t,a)}).fail(function(a,o){moduloMenus.error()})}),$(".boton-envio-mensaje").on("click",function(){moduloActividad.on();var o=$(this),n=o.attr("data-url");void 0!==n&&0!=n.length||(n="/act/correo");var e=o.attr("data-once");e=void 0===e||0==e.length;var i=o.closest(".contenedor-envio-mensajes");if(i){i.find("[property='error']").remove(),i.find('[property="gracias"]').addClass("invisible");for(var r={},c=t(i,r),u=0,d=0;d<c.length;d++){var l=c[d];0!=l.error&&(a(i,l.msg,"error"),u++)}if(u>0)return void moduloActividad.off();$.ajax({type:"PUT",url:n,data:JSON.stringify(r),contentType:"application/json; charset=utf-8"}).done(function(o){0==o.error?(e&&i.children().addClass("invisible"),i.find('[property="gracias"]').removeClass("invisible")):a(i,o.msg,"error"),moduloActividad.off()}).fail(function(o,n){a(i,n,"error"),moduloActividad.off()})}})}(),{}};